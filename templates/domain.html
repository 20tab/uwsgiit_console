{% extends 'index.html' %}
{% load console_tags %}

{% block extra_style %}
    {{ block.super }}
    <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}rickshaw/rickshaw.min.css">
{% endblock %}
{% block extra_head %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}rickshaw/vendor/d3.v3.js"></script>
    <script src="{{ STATIC_URL }}rickshaw/rickshaw.min.js"></script>
{% endblock %}

{% block content %}

    <h3>Domain <b>{{ domain.name }}</b></h3>

    <ul class="nav nav-tabs">
      <li class="{% if not active_panel %}active{% endif %}">
          <a href="#infos" data-toggle="tab">Info</a>
      </li>
      <li{% if active_panel == 'metrics' %} class="active"{% endif %}>
          <a href="#metrics" data-toggle="tab">Metrics</a>
      </li>
    </ul>


    <!-- Tab panes -->
    <div class="tab-content">

        <!-- INFO -->
        <div class="tab-pane{% if not active_panel %} active{% endif %}" id="infos">
            <div class="table-responsive">
                <form id="domain-form" class="form-inline" role="form" action="{% url 'domain' domain.id %}" method="post">
                    {% csrf_token %}
                    <table class="table table-hover table-bordered">
                    {% for k, v in domain.items %}
                        <tr>
                            <td>{{ k|get_title }}</td>
                            <td>{{ v }}</td>
                        </tr>
                    {% endfor %}
                        {{ domainform }}
                    </table>
                    <button id="update-domain" type="submit" data-loading-text="Loading..." class="btn btn-primary submit-domain-form"onclick="$('#update-domain').button('loading');">
                        Update
                    </button>
                </form>
                {# <a href="?del={{ d.0.name }}"><span class="glyphicon glyphicon-remove-circle" style="position:right"></span>Delete Domain</a> #}
            </div>
        </div>


       <div class="tab-pane{% if active_panel == 'metrics' %} active{% endif %}" id="metrics">
            <div class="row margin-top">
                <div class="col-sm-3 col-lg-2">
                    <ul class="nav nav-pills nav-stacked">
                        <li class="{% if not active_panel %}active{% endif %}">
                            <a href="#" data-toggle="tab" onclick="$('#calendar').attr('action', '{% url 'domain_net_rx' domain.id %}'); clearGraph();">Domain Network RX</a>
                        </li>
                        <li{% if active_panel == 'domain_net_tx' %} class="active"{% endif %}>
                            <a href="#" data-toggle="tab" onclick="$('#calendar').attr('action', '{% url 'domain_net_tx' domain.id %}'); clearGraph();">Domain Network TX</a>
                        </li>
                        <li{% if active_panel == 'domain_hits' %} class="active"{% endif %}>
                            <a href="#" data-toggle="tab" onclick="$('#calendar').attr('action', '{% url 'domain_hits' domain.id %}'); clearGraph();">Domain Hits</a>
                        </li>
                    </ul>
                </div>
                <div class="col-sm-9 col-lg-10">
                    <form action="{% url 'domain_net_rx' domain.id %}" method="post" class="form-horizontal inline" id="calendar">
                        {% csrf_token %}
                        {{ calendar }}
                        <button id="get-metrics" type="submit" data-loading-text="Loading..." class="btn btn-primary">Go</button>
                    </form>
                    <button class="inline btn btn-primary" onclick="clearGraph();">Clear Graphs</button>
                    <div id="chart_container" class="clearfix">
                        <div id="chart"></div>
                        <div id="timeline"></div>
                        <div id="legend_container">
                            <div id="smoother" title="Smoothing"></div>
                            <div id="legend"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block footer_js %}
    {{ block.super }}
    <script src="{{ STATIC_URL }}js/metrics.js"></script>
{% endblock %}
